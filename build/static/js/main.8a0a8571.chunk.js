(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{28:function(e,t,n){e.exports=n(55)},55:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(25),i=n.n(l),o=n(2),u=n(9),c=n(1),s=function(e){var t=e.review;return r.a.createElement("div",{style:{margin:20}},r.a.createElement("div",null,r.a.createElement("b",null,"Rating:")," ",t.rating),r.a.createElement("div",null,r.a.createElement("b",null,"Review:")," ",t.review),r.a.createElement("div",null,r.a.createElement("b",null,"Author:")," ",t.user," ",t.date))},m=function(e){var t=e.movie,n=e.selectToShow,a=e.toShow,l=function(e){n(e)},i={clear:"both",cursor:"pointer"};return a!==t.Title?r.a.createElement("h3",{onClick:function(){return l(t.Title)},style:i},t.Title," ",t.Year):a===t.Title?r.a.createElement("div",null,r.a.createElement("h3",{onClick:function(){return l(t.Title)},style:i},t.Title," ",t.Year),r.a.createElement("div",{style:{display:"inline-block",float:"left",marginRight:100}},r.a.createElement("img",{src:t.Poster,alt:"Poster"})),r.a.createElement("div",{style:{marginLeft:100,textAlignVertical:"top"}},r.a.createElement("h2",null," IMDB-rating:",t.imdb),t.reviews.map((function(e,t){return r.a.createElement(s,{key:t,review:e})})))):void 0},v=function(e){var t=e.movies,n=Object(a.useState)(null),l=Object(o.a)(n,2),i=l[0],u=l[1],c=function(e){u(e===i?null:e)};return r.a.createElement("div",{style:{margin:20}},r.a.createElement("h2",null,"Movies"),r.a.createElement("div",{style:{marginLeft:20,marginTop:10}},t.map((function(e,t){return r.a.createElement(m,{key:t,movie:e,toShow:i,selectToShow:c})}))))},g=n(26),f=n.n(g),d=function(e){var t=e.movie,n=e.getReview,l=Object(a.useState)(5),i=Object(o.a)(l,2),u=i[0],c=i[1],s=Object(a.useState)(""),m=Object(o.a)(s,2),v=m[0],g=m[1],d=Object(a.useState)(!1),E=Object(o.a)(d,2),p=E[0],b=E[1];return null===t?null:r.a.createElement("div",null,r.a.createElement("div",{style:{display:"inline-block",float:"left",marginRight:110,marginLeft:50}},r.a.createElement("h2",null," ",t.Title," ",t.Year," "),r.a.createElement("h3",null," IMDB-rating:",t.imdbRating),r.a.createElement("p",null,r.a.createElement("img",{src:t.Poster,alt:"Poster"}))),r.a.createElement("form",{style:{overflowX:"auto"},onSubmit:function(e){if(e.preventDefault(),v.length>3){b(!0);var a={Title:t.Title,Year:t.Year,Poster:t.Poster,imdb:t.imdbRating,reviews:[]};console.log(a.imdb),a.reviews.push({rating:u,review:v}),console.log(a),n(a),c(5),g(""),setTimeout((function(){b(!1)}),1e3)}}},r.a.createElement("h2",null,"Review movie"),"Rating ",r.a.createElement(f.a,{required:!0,min:0,max:10,step:.1,value:u,name:"rating",onChange:c}),r.a.createElement("p",null," Review"),r.a.createElement("p",null,r.a.createElement("textarea",{value:v,name:"review",rows:23,cols:90,onChange:function(e){var t=e.target;return g(t.value)}})),r.a.createElement("button",{type:"submit",disabled:p},"Save review")))},E=function(e){var t=e.getLoginInformation,n=Object(a.useState)(""),l=Object(o.a)(n,2),i=l[0],u=l[1],c=Object(a.useState)(""),s=Object(o.a)(c,2),m=s[0],v=s[1];return r.a.createElement("div",{style:{margin:22}},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(i,m),u(""),v("")}},r.a.createElement("div",null,"username",r.a.createElement("input",{type:"text",value:i,name:"Username",onChange:function(e){var t=e.target;return u(t.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",value:m,name:"Password",onChange:function(e){var t=e.target;return v(t.value)}})),r.a.createElement("button",{type:"submit"},"login")))},p={margin:20},b=function(){return r.a.createElement("div",{style:p},r.a.createElement("h2",null,"Welcome to use THE REVIEWER"),r.a.createElement("p",null,"This is an app for reading and writing reviews for movies. You can read reviews without signing in, but to write a review you must make an account for the site. You will see the reviews by cliking the title of the movie"),r.a.createElement("p",null,"The site has been made using React, MongoDB and node.js."))},h=function(e){var t=e.getSignUpIformation,n=Object(a.useState)(""),l=Object(o.a)(n,2),i=l[0],u=l[1],s=Object(a.useState)(""),m=Object(o.a)(s,2),v=m[0],g=m[1],f=Object(a.useState)(""),d=Object(o.a)(f,2),E=d[0],p=d[1];Object(c.f)();return r.a.createElement("div",{style:{margin:22}},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log(t(i,v,E)),u(""),g(""),p("")}},r.a.createElement("div",null,"username",r.a.createElement("input",{type:"text",value:i,name:"Username",onChange:function(e){var t=e.target;return u(t.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",value:v,name:"Password",onChange:function(e){var t=e.target;return g(t.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",value:E,name:"Password2",onChange:function(e){var t=e.target;return p(t.value)}})),r.a.createElement("button",{type:"submit"},"Sign up")))},w=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{style:{color:"red",margin:10}},t)},y=function(e){var t=e.getSearchedTitle,n=Object(a.useState)(""),l=Object(o.a)(n,2),i=l[0],u=l[1];return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(i),u("")}},r.a.createElement("h2",null,"Search movie to review"),"Title ",r.a.createElement("input",{type:"text",value:i,name:"search",onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement("button",{type:"submit"},"Search movie")))},O=n(8),S=n.n(O),j=null,T=function(){return S.a.get("/api/movies").then((function(e){return e.data}))},k=function(e){return S.a.get("".concat("/api/movies","/").concat(e)).then((function(e){return e.data}))},R=function(e){j="bearer ".concat(e)},I=function(e){var t="https://www.omdbapi.com/?t=".concat(e,"&apikey=d20392f7");return S.a.get(t).then((function(e){return e}))},C=function(e){var t={headers:{Authorization:j}};return S.a.post("/api/movies",e,t).then((function(e){return e.data}))},P=function(e){return S.a.post("/api/login",e).then((function(e){return e.data}))},x=function(e){return S.a.post("/api/users",e).then((function(e){return e.data}))},L=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],l=t[1],i=Object(a.useState)(null),s=Object(o.a)(i,2),m=s[0],g=s[1],f=Object(a.useState)(null),p=Object(o.a)(f,2),O=p[0],S=p[1],j=Object(a.useState)(null),L=Object(o.a)(j,2),Y=L[0],A=L[1],B=Object(a.useState)([]),D=Object(o.a)(B,2),U=D[0],_=D[1],J=function(e,t){return e.Title>t.Title?1:t.Title>e.Title?-1:0};Object(a.useEffect)((function(){T().then((function(e){e.sort(J),l(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);S(t),R(t.token),t&&k(t.id).then((function(e){null!==e&&(e.movies.sort(J),_(e.movies))}))}}),[]);var M=function(e,t){P({username:e,password:t}).then((function(e){window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(e)),R(e.token),k(e.id).then((function(e){e.movies.sort(J),_(e.movies)})),S(e)})).catch((function(e){A("".concat(e.response.data.error)),setTimeout((function(){A(null)}),6e3)}))},N={padding:15};return r.a.createElement("div",{style:{margin:50,overflowX:"auto"}},r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement(u.b,{style:N,to:"/"},"home"),r.a.createElement(u.b,{style:N,to:"/reviews"},"all reviews"),r.a.createElement(u.b,{style:N,to:"/your_reviews"},"movies reviewed by you"),r.a.createElement(u.b,{style:N,to:"/make_review"},"make review"),O?null:r.a.createElement(u.b,{style:N,to:"/sign_up"},"Sign up"),O?r.a.createElement("em",null,O.username," logged in ",r.a.createElement("button",{onClick:function(){window.localStorage.removeItem("loggedBlogAppUser"),S(null),R(null),_([])}}," Logout")):r.a.createElement("span",null,"You are not logged in")),r.a.createElement(c.c,null,r.a.createElement(c.a,{path:"/sign_up"},r.a.createElement(w,{message:Y}),r.a.createElement(h,{getSignUpIformation:function(e,t,n){if(t!==n)return A("Passwords didn't match"),setTimeout((function(){A(null)}),6e3),!1;x({userName:e,password:t}).then((function(e){M(e.userName,t),console.log("Oikein, pit\xe4isi tulla true"),A('Account created. Redirect doesn\'t work yet,please click "make review"'),setTimeout((function(){A(null)}),16e3)})).catch((function(e){return console.log(e.response),A(e.response.data.message),setTimeout((function(){A(null)}),6e3),console.log("V\xe4\xe4rin, pit\xe4isi tulla false"),!1}))}})),r.a.createElement(c.a,{path:"/reviews"},r.a.createElement(v,{movies:n})),r.a.createElement(c.a,{path:"/your_reviews"},O?r.a.createElement(v,{movies:U}):r.a.createElement("div",null,r.a.createElement(w,{message:Y}),r.a.createElement(E,{getLoginInformation:M}))),r.a.createElement(c.a,{path:"/make_review"},O?r.a.createElement("div",null,r.a.createElement(y,{getSearchedTitle:function(e){I(e).then((function(e){"False"!==e.data.Response?g(e.data):g(null)})).catch((function(e){console.log(e)}))}}),r.a.createElement(d,{movie:m,getReview:function(e){e.reviews[0].date="today",e.reviews[0].user=O.username,console.log("Lis\xe4ys"),C(e).then((function(t){var a=n.findIndex((function(t){return t.Title===e.Title}));if(-1===a){e.reviews.length=0,e.reviews.push(t);var r=n.concat(e);r.sort(J),l(r)}else{var i=n.concat();i[a].reviews.push(t),console.log("K\xe4yk\xf6 2 kertaa"),l(i)}var o=U.findIndex((function(t){return t.Title===e.Title}));if(-1===o){var u;(u=-1===a?U.concat(e):U.concat(n[a])).sort(J),_(u)}else{var c=U.concat();c[o].reviews.push(t),_(c)}g(null)}))}})):r.a.createElement("div",null,r.a.createElement(w,{message:Y}),r.a.createElement(E,{getLoginInformation:M}))),r.a.createElement(c.a,{path:"/login"},r.a.createElement(E,{getLoginInformation:M})),r.a.createElement(c.a,{path:"/"},r.a.createElement(b,null))),r.a.createElement("footer",{style:{clear:"both",marginTop:40,bottom:0,padding:20,backgroundColor:"grey"}},r.a.createElement("i",null,"Teemu Hallinen, Ohjelmistosuunnittelu t\xe4ydennyskoulutus 2019-2020"))))};i.a.render(r.a.createElement(L,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.8a0a8571.chunk.js.map