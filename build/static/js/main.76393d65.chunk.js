(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{29:function(e,t,n){e.exports=n(56)},56:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(26),i=n.n(l),o=n(15),c=n(3),u=n(9),m=n(1),s=function(e){var t=e.review;return r.a.createElement("div",{style:{margin:20}},r.a.createElement("div",null,"Rating: ",t.rating),r.a.createElement("div",null,"Review: ",t.review),r.a.createElement("div",null,t.user," ",t.date))},v=function(e){var t=e.movie,n=Object(a.useState)(!1),l=Object(c.a)(n,2),i=l[0],o=l[1],u=function(){o(!i)},m={clear:"both"};return!1===i?r.a.createElement("h3",{onClick:u,style:m},t.Title," ",t.Year):!0===i?r.a.createElement("div",null,r.a.createElement("h3",{onClick:u,style:m},t.Title," ",t.Year),r.a.createElement("div",{style:{display:"inline-block",float:"left",marginRight:100}},r.a.createElement("img",{src:t.Poster,alt:"Poster"})),r.a.createElement("div",{style:{marginLeft:100,textAlignVertical:"top"}},r.a.createElement("h2",null," IMDB-rating:",t.imdb),t.reviews.map((function(e,t){return r.a.createElement(s,{key:t,review:e})})))):void 0},g=function(e){var t=e.movies;return r.a.createElement("div",null,r.a.createElement("h2",null,"Movies"),t.map((function(e,t){return r.a.createElement(v,{key:t,movie:e})})))},f=n(27),E=n.n(f),d=function(e){var t=e.movie,n=e.getReview,l=Object(a.useState)(5),i=Object(c.a)(l,2),o=i[0],u=i[1],m=Object(a.useState)(""),s=Object(c.a)(m,2),v=s[0],g=s[1];return null===t?null:r.a.createElement("div",null,r.a.createElement("h2",null," ",t.Title," ",t.Year," "),r.a.createElement("p",null,r.a.createElement("img",{src:t.Poster,alt:"Poster"})),"IMDB-rating:",t.imdbRating,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a={Title:t.Title,Year:t.Year,Poster:t.Poster,imdb:t.imdbRating,reviews:[]};console.log(a.imdb),a.reviews.push({rating:o,review:v}),console.log(a),n(a),u(""),g("")}},r.a.createElement("h2",null,"Review movie"),"Rating ",r.a.createElement(E.a,{required:!0,min:0,max:10,step:.1,value:o,name:"rating",onChange:u}),r.a.createElement("p",null," Review"),r.a.createElement("p",null,r.a.createElement("textarea",{value:v,name:"review",rows:8,cols:50,onChange:function(e){var t=e.target;return g(t.value)}})),r.a.createElement("button",{type:"submit"},"Rate movie")))},p=function(e){var t=e.getLoginInformation,n=Object(a.useState)(""),l=Object(c.a)(n,2),i=l[0],o=l[1],u=Object(a.useState)(""),m=Object(c.a)(u,2),s=m[0],v=m[1];return r.a.createElement("div",{style:{margin:22}},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(i,s),o(""),v("")}},r.a.createElement("div",null,"username",r.a.createElement("input",{type:"text",value:i,name:"Username",onChange:function(e){var t=e.target;return o(t.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",value:s,name:"Password",onChange:function(e){var t=e.target;return v(t.value)}})),r.a.createElement("button",{type:"submit"},"login")))},b={margin:20},h=function(){return r.a.createElement("div",{style:b},r.a.createElement("h2",null,"Welcome to use THE REVIEWER"),r.a.createElement("p",null,"This is an app for reading and writing reviews for movies. You can read reviews without singing in, but to write a review you must make an account for the site."),r.a.createElement("p",null,"The site has been made using React, MongoDB and node.js."))},w=function(e){var t=e.getSearchedTitle,n=Object(a.useState)(""),l=Object(c.a)(n,2),i=l[0],o=l[1];return r.a.createElement("div",{style:{margin:20}},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(i),o("")}},r.a.createElement("h2",null,"Search movie"),"Title ",r.a.createElement("input",{type:"text",value:i,name:"search",onChange:function(e){var t=e.target;return o(t.value)}}),r.a.createElement("button",{type:"submit"},"Search movie")))},y=n(8),O=n.n(y),j=null,S=function(){return O.a.get("/api/movies").then((function(e){return e.data}))},T=function(e){return O.a.get("".concat("/api/movies","/").concat(e)).then((function(e){return e.data}))},k=function(e){j="bearer ".concat(e)},R=function(e){var t="https://www.omdbapi.com/?t=".concat(e,"&apikey=d20392f7");return O.a.get(t).then((function(e){return e}))},I=function(e){var t={headers:{Authorization:j}};return O.a.post("/api/movies",e,t).then((function(e){return e.data}))},x=function(e){return O.a.post("http://localhost:3001/api/login",e).then((function(e){return e.data}))},C=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],l=t[1],i=Object(a.useState)(null),s=Object(c.a)(i,2),v=s[0],f=s[1],E=Object(a.useState)(null),b=Object(c.a)(E,2),y=b[0],O=b[1],j=Object(a.useState)(null),C=Object(c.a)(j,2),B=(C[0],C[1],Object(a.useState)([])),L=Object(c.a)(B,2),P=L[0],Y=L[1],D=function(e,t){return e.Title>t.Title?1:t.Title>e.Title?-1:0};Object(a.useEffect)((function(){S().then((function(e){e.sort(D),l(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);O(t),k(t.token),t&&T(t.id).then((function(e){e.movies.sort(D),Y(e.movies)}))}}),[]);var A=function(e,t){x({username:e,password:t}).then((function(e){window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(e)),k(e.token),T(e.id).then((function(e){Y(e.movies)})),O(e)})).catch((function(){return console.log("Login failed")}))},J={padding:5};return r.a.createElement("div",{style:{margin:20}},r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement(u.b,{style:J,to:"/"},"home"),r.a.createElement(u.b,{style:J,to:"/reviews"},"all reviews"),r.a.createElement(u.b,{style:J,to:"/your_reviews"},"movies reviewed by you"),r.a.createElement(u.b,{style:J,to:"/make_review"},"make review"),y?r.a.createElement("em",null,y.username," logged in ",r.a.createElement("button",{onClick:function(){window.localStorage.removeItem("loggedBlogAppUser"),O(null),k(null),Y([])}}," Logout")):r.a.createElement("span",null,"You are not logged in")),r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/reviews"},r.a.createElement(g,{movies:n})),r.a.createElement(m.a,{path:"/your_reviews"},y?r.a.createElement(g,{movies:P}):r.a.createElement(p,{getLoginInformation:A})),r.a.createElement(m.a,{path:"/make_review"},y?r.a.createElement("div",null,r.a.createElement(w,{getSearchedTitle:function(e){R(e).then((function(e){"False"!==e.data.Response?f(e.data):f(null)})).catch((function(e){console.log(e)}))}}),r.a.createElement(d,{movie:v,getReview:function(e){e.reviews[0].user=y.username,console.log(e.imdb),I(e).then((function(t){var a=n.findIndex((function(t){return t.Title===e.Title}));if(-1===a)l(n.concat(e));else{var r=Object(o.a)(n);r[a].reviews.push(t),l(r)}var i=P.findIndex((function(t){return t.Title===e.Title}));if(-1===i)Y(P.concat(e));else{var c=Object(o.a)(P);c[i].reviews.push(t),Y(c)}f(null)}))}})):r.a.createElement(p,{getLoginInformation:A})),r.a.createElement(m.a,{path:"/login"},r.a.createElement(p,{getLoginInformation:A})),r.a.createElement(m.a,{path:"/"},r.a.createElement(h,null))),r.a.createElement("div",{style:{clear:"both"}},r.a.createElement("i",null,"Teemu Hallinen, Ohjelmistosuunnittelu t\xe4ydennyskoulutus 2019-2020"))))};i.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.76393d65.chunk.js.map