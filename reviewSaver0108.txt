
   // event.preventDefault()
   // const review ={...movieToReview,rating}
  
 //  review = {...review,user:user.username}
    review.reviews[0].date ="today"
    review.reviews[0].user = user.username

    console.log("Lisäys")
    movieService.create(review).then((newReview)=>
    {
      const index = movies.findIndex((movie)=>
      {
       return movie.Title ===review.Title
      })
      
      if(index === -1)
      {
        review.reviews.length = 0//poistaa tallentamisessa käytetyn arvostelun, lisää backendin palauttaman arvostelun
        review.reviews.push(newReview)
        let sortArray = movies.concat(review)

      sortArray.sort(sortByTitle)
    

      setMovies(sortArray)
      //setMovies(movies.concat(review))    //Kaataa ohjelman jos tekee toisen arvoselun samalla istunnolla
      }
      else
      {
        let newArray =movies.concat()
        //newArray[index] = {...newArray[index].reviews.push(newReview)}

       
        newArray[index].reviews.push(newReview)
       console.log("Käykö 2 kertaa")
        setMovies(newArray)
       
      }

      const indexOwnReviews = usersMovies.findIndex((movie)=>
      {
       return movie.Title ===review.Title
      })
      
      if(indexOwnReviews === -1)
      {
    
        let sortArray
       
        if(index ===-1)
         sortArray = usersMovies.concat(review)
        else      //Jos leffaa on jo arvostelu,mutta uusi kyseiselle käyttäjälle
        sortArray =usersMovies.concat(movies[index])
        
        sortArray.sort(sortByTitle)
       setUsersMovies(sortArray)
      //setUsersMovies(usersMovies.concat(review))    //Kaataa ohjelman jos tekee toisen arvoselun samalla istunnolla
      }
      else    
      {
        let tmpArray = usersMovies.concat()

     /*
     let deletedItem = tmpArray.filter((item)=>
        {
          return item.Title !== review.Title
        })

        deletedItem.concat(movies[index])

        deletedItem.sort(sortByTitle)
        */
        
      /*  let tmpArray = usersMovies.concat()
        //newArray[index] = {...newArray[index].reviews.push(newReview)}

       console.log(newReview)
        
       */
    //  tmpArray[indexOwnReviews].reviews.push(review.reviews[0])
    tmpArray[indexOwnReviews].reviews.push(newReview)
        setUsersMovies(tmpArray)
        
       
      }



      setMovieToReview(null)
    })
 